# ミドルウエア  
  
## 解説  
* WebアプリのHTTPリクエストとレスポンスの処理をカスタマイズするための仕組み。    

* コントローラーが特定のアクションのみに反応するのに対し、指定したリクエスト全体に関与する。
  
* リクエストがサーバーに到達した時点からレスポンスがクライアントに返されるまでの間に様々な処理を挟み込むことが可能。
    
* 認証や認可、ログの記録、圧縮、エラー処理などのアプリ全体で共通して行いたい処理を集中化できる。

* メソッド同様にあらかじめ用意されているミドルウエアの他に自身で設定可能なカスタムミドルウエアを使用することが可能。

* ミドルウエアは`デリゲート`と呼ばれるミドルウエア内の各種処理結果情報を保持した変数を返す。
  (Railsにおけるエラーハンドリングに使用するメソッドのようなもの)
  
## 雛形   
```C#
  # ミドルウエアをapp.Use()メソッドでパイプラインに追加する
  #　next⇒次のミドルウエア内で特定の条件を満たした場合等指定したタイミングで次のミドルウエアに処理を移行する。
  app.Use(async (context, next) =>
  {
    // リクエスト処理の前に実行される処理
    // 例：ログ出力、認証、リクエストヘッダーの変更など

    // 次のミドルウェアへ処理を移譲
    await next();

    // リクエスト処理の後に実行される処理
    // 例：レスポンスヘッダーの変更、エラー処理など
  });
```
## 関連ワード  
